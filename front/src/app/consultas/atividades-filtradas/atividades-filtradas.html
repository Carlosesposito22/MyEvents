<div *ngIf="open" class="modal-overlay" (click)="close()">
  <div class="modal-content animate-scale" (click)="$event.stopPropagation()">

    <button class="modal-close" (click)="close()">‚úñ</button>
    <div style="display: flex; align-items: center; justify-content: space-between;">
        <h2 class="titulo-pagina">üîç Atividades por Categoria e Data</h2>
    </div>

    <div class="form-filtros">
      <div class="form-grupo">
        <label for="filtro-categoria">Nome da Categoria</label>
        <input id="filtro-categoria" type="text" [(ngModel)]="nomeCategoria"  placeholder="Ex: 'Tecnologia' ou 'Sa√∫de'">
      </div>
      
      <div class="grupo-datas">
        <div class="form-grupo">
          <label for="filtro-data-inicio">Data In√≠cio (Evento)</label>
          <input id="filtro-data-inicio" type="date" [(ngModel)]="dataInicio">
        </div>
        <div class="form-grupo">
          <label for="filtro-data-fim">Data Fim (Evento)</label>
          <input id="filtro-data-fim" type="date" [(ngModel)]="dataFim">
        </div>
      </div>
      
      <button class="btn-buscar" (click)="buscarAtividades()" [disabled]="loading">
        <span *ngIf="!loading">Buscar Atividades</span>
        <span *ngIf="loading" class="spinner-btn"></span>
      </button>
    </div>

    <hr class="form-divider">

    <div class="area-resultados">
      
      <div *ngIf="!buscaRealizada && !loading" class="evento-vazio" style="min-height: 150px;">
        <span style="font-size: 1.5rem;">üëÜ</span>
        <strong>Preencha os filtros acima</strong>
      </div>

      <div *ngIf="loading" class="loading" style="min-height: 150px; justify-content: center;">
        <span class="spinner"></span> Carregando atividades...
      </div>

      <div *ngIf="error && !loading" class="evento-erro" style="min-height: 150px; text-align: center;">
        ‚ö†Ô∏è {{ error }}
      </div>
      
      <div *ngIf="buscaRealizada && !loading && !error && atividades.length === 0" class="evento-vazio" style="min-height: 150px;">
        <span style="font-size: 1.5rem;">üö´</span>
        <strong>Nenhuma atividade encontrada</strong>
        <p>N√£o h√° atividades para os filtros selecionados.</p>
      </div>

      <div *ngIf="atividades.length > 0 && !loading" class="table-container-modal">
        <table>
          <thead>
            <tr>
              <th>ID Ativ.</th>
              <th>T√≠tulo da Atividade</th>
              <th>Evento Pertencente</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let atividade of atividades">
              <td>{{ atividade.id_atividade }}</td>
              <td>{{ atividade.tituloAtividade }}</td>
              <td>{{ atividade.tituloEvento }}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

  </div>
</div>

<style>
  .form-filtros {
    display: flex;
    flex-direction: column;
    gap: 15px;
    margin-top: 10px;
  }
  .grupo-datas {
    display: flex;
    gap: 15px;
    width: 100%;
  }
  .grupo-datas .form-grupo {
    flex: 1;
  }
  .form-grupo {
    display: flex;
    flex-direction: column;
    width: 100%;
  }
  .form-grupo label {
    font-weight: 600;
    font-size: 0.9rem;
    color: #495057;
    margin-bottom: 6px;
  }
  .form-grupo input[type="text"],
  .form-grupo input[type="date"] {
    padding: 10px 12px;
    border: 1px solid #ced4da;
    border-radius: 6px;
    font-size: 1rem;
    font-family: inherit;
  }
  .form-grupo input[type="text"]:focus,
  .form-grupo input[type="date"]:focus {
    outline: none;
    border-color: #226d44;
    box-shadow: 0 0 0 3px rgba(34, 109, 68, 0.1);
  }

  .btn-buscar {
    padding: 12px 16px;
    font-size: 1rem;
    font-weight: 600;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.2s;
    font-family: inherit;
    background-color: #226d44; 
    border: 1px solid #226d44;
    color: #fff;
    display: flex;
    align-items: center;
    justify-content: center;
    min-height: 45px;
  }
  .btn-buscar:hover {
    background-color: #1a5233;
    border-color: #1a5233;
  }
  .btn-buscar:disabled {
    background-color: #9e9e9e;
    border-color: #9e9e9e;
    cursor: not-allowed;
  }
  .spinner-btn {
    width: 20px;
    height: 20px;
    border: 3px solid rgba(255, 255, 255, 0.3);
    border-radius: 50%;
    border-top-color: #fff;
    animation: spin 0.8s linear infinite;
  }
  @keyframes spin {
    to { transform: rotate(360deg); }
  }

  .form-divider {
    border: none;
    border-top: 1px solid #e9ecef;
    margin: 25px 0;
  }

  .area-resultados {
    max-height: 40vh;
    overflow-y: auto;
  }
  .table-container-modal {
    border: 1px solid #e9ecef;
    border-radius: 8px;
  }
  .table-container-modal table {
    width: 100%;
    border-collapse: collapse;
    text-align: left;
  }
  .table-container-modal th,
  .table-container-modal td {
    padding: 12px 16px;
    border-bottom: 1px solid #f0f0f0;
    font-size: 0.95rem;
  }
  .table-container-modal th {
    background-color: #f8f9fa;
    font-weight: 600;
    color: #495057;
  }
  .table-container-modal tr:last-child td {
    border-bottom: none;
  }
  .table-container-modal td:nth-child(2) {
    font-weight: 500;
  }
</style>