<div class="dashboard-container">
  <!-- Header -->
  <header class="dashboard-header">
    <h1>üìä Dashboard Estat√≠stico de Eventos</h1>
    <p class="subtitle">An√°lise completa de indicadores e m√©tricas de eventos</p>
  </header>
  <!-- Loading e Error States -->
  <div *ngIf="loading" class="loading-container">
    <div class="spinner"></div>
    <p>Carregando dados do dashboard...</p>
  </div>
  <!-- Dashboard Content -->
  <div *ngIf="!loading && !error && dashboardData" class="dashboard-content">
    <!-- Filtros -->
    <section class="filters-section">
      <h2>Filtros</h2>
      <div class="filters-grid">
        <div class="filter-group">
          <label for="categoria">Categoria:</label>
          <select id="categoria" [(ngModel)]="filtroCategoria">
            <option value="">Todas as Categorias</option>
            <option *ngFor="let cat of categorias" [value]="cat">{{cat}}</option>
          </select>
        </div>
        <div class="filter-group">
          <label for="dataInicio">Data In√≠cio:</label>
          <input type="date" id="dataInicio" [(ngModel)]="filtroDataInicio">
        </div>
        <div class="filter-group">
          <label for="dataFim">Data Fim:</label>
          <input type="date" id="dataFim" [(ngModel)]="filtroDataFim">
        </div>
        <div class="filter-actions">
          <button class="btn btn-primary" (click)="aplicarFiltros()">Aplicar Filtros</button>
          <button class="btn btn-secondary" (click)="limparFiltros()">Limpar</button>
          <button class="btn btn-export" (click)="exportarRelatorio()">üì• Exportar</button>
        </div>
      </div>
    </section>
    <!-- Indicadores Resumidos -->
    <section class="indicators-section">
      <h2>Indicadores Resumidos</h2>
      <div class="indicators-grid">
        <div class="indicator-card">
          <h3>Total de Eventos</h3>
          <p class="indicator-value">{{ dashboardData.totalEventos }}</p>
          <span class="indicator-label">Eventos cadastrados</span>
        </div>
        <div class="indicator-card">
          <h3>Total de Participantes</h3>
          <p class="indicator-value">{{ dashboardData.totalParticipantes }}</p>
          <span class="indicator-label">Participa√ß√µes registradas</span>
        </div>
        <div class="indicator-card">
          <h3>Total de Palestrantes</h3>
          <p class="indicator-value">{{ dashboardData.totalPalestrantes }}</p>
          <span class="indicator-label">Palestrantes ativos</span>
        </div>
        <div class="indicator-card">
          <h3>Total de Atividades</h3>
          <p class="indicator-value">{{ dashboardData.totalAtividades }}</p>
          <span class="indicator-label">Atividades programadas</span>
        </div>
        <div class="indicator-card">
          <h3>M√©dia de Participantes/Evento</h3>
          <p class="indicator-value">{{ dashboardData.mediaParticipantesPorEvento | number }}</p>
          <span class="indicator-label">Participantes por evento</span>
        </div>
        <div class="indicator-card">
          <h3>M√©dia de Horas/Evento</h3>
          <p class="indicator-value">{{ dashboardData.mediaHorasPorEvento | number }}h</p>
          <span class="indicator-label">Carga hor√°ria m√©dia</span>
        </div>
      </div>
    </section>
    <!-- Estat√≠sticas Descritivas -->
    <section class="statistics-section">
      <h2>Estat√≠sticas Descritivas de Participantes</h2>
      <div class="statistics-grid">
        <div class="stat-card">
          <h4>M√©dia</h4>
          <p class="stat-value">{{ dashboardData.estatisticasParticipantes.media | number}}</p>
        </div>
        <div class="stat-card">
          <h4>Mediana</h4>
          <p class="stat-value">{{ dashboardData.estatisticasParticipantes.mediana }}</p>
        </div>
        <div class="stat-card">
          <h4>Moda</h4>
          <p class="stat-value">{{ dashboardData.estatisticasParticipantes.moda }}</p>
        </div>
        <div class="stat-card">
          <h4>Vari√¢ncia</h4>
          <p class="stat-value">{{ dashboardData.estatisticasParticipantes.variancia | number: '1.2-2' }}</p>
        </div>
        <div class="stat-card">
          <h4>Desvio Padr√£o</h4>
          <p class="stat-value">{{ dashboardData.estatisticasParticipantes.desviopadrao | number: '1.2-2' }}</p>
        </div>
        <div class="stat-card">
          <h4>Correla√ß√£o Horas/Participantes</h4>
          <p class="stat-value">{{ dashboardData.correlacaoHorasParticipantes | number: '1.2-2' }}</p>
        </div>
      </div>
    </section>
    <!-- Gr√°ficos Din√¢micos -->
    <section class="charts-section">
      <h2>Visualiza√ß√µes Din√¢micas</h2>

      <!-- Gr√°fico 1: Eventos por Categoria (Barras) -->
      <div class="chart-container">
        <h3>Gr√°fico 1: Eventos por Categoria</h3>
        <div class="chart-placeholder">
          <p>üìä Gr√°fico de Barras - Distribui√ß√£o de eventos por categoria</p>
          <div class="chart-data">
            <div *ngFor="let cat of dashboardData.categoriasComMaisEventos" class="chart-bar">
              <span class="bar-label">{{ cat.nome }}</span>
              <div class="bar" [style.width.%]="(cat.quantidade / 8) * 100">
                {{ cat.quantidade }}
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Gr√°fico 2: Participantes por Evento (Pizza)      -->
      <div class="chart-container">
        <h3>Gr√°fico 2: Distribui√ß√£o de Participantes por Evento</h3>
        <div class="chart-placeholder">
          <p>ü•ß Gr√°fico de Pizza - Participantes nos 3 eventos mais populares</p>
          <!-- >>>>>> AJUSTE AQUI! Canvas para Chart.js puro <<<<<< -->
          <canvas id="pieCanvas"></canvas>
        </div>
      </div>

      <!-- Os outros gr√°ficos permanece igual, s√≥ mudando se voc√™ for adicionar mais canvas/Chart.js -->
      <!-- MANTENHA NORMAL A PARTIR DAQUI -->

      <!-- Gr√°fico 3: Tend√™ncia de Eventos (Linha) -->
      <div class="chart-container">
        <h3>Gr√°fico 3: Tend√™ncia de Eventos por M√™s</h3>
        <div class="chart-placeholder chart-line-horizontal">
          <div class="chart-line-canvas">
            <canvas id="lineCanvas"></canvas>
          </div>
          <div class="line-highlights" *ngIf="dashboardData?.tendenciaEventosPorMes?.length">
            <div class="line-highlight-card high">
              <span class="label"><span class="icon-up">‚¨ÜÔ∏è</span> Mais eventos</span>
              <strong class="highlight-value">{{ maiorMes?.mes }}</strong>
              <span class="subtitle">{{ maiorMes?.quantidade }} eventos</span>
            </div>
            <div class="line-highlight-card low">
              <span class="label"><span class="icon-down">‚¨áÔ∏è</span> Menos eventos</span>
              <strong class="highlight-value">{{ menorMes?.mes }}</strong>
              <span class="subtitle">{{ menorMes?.quantidade }} eventos</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Gr√°fico 4: Distribui√ß√£o de Participantes (Barras Horizontal) -->
      <div class="chart-container">
        <h3>Gr√°fico 4: Distribui√ß√£o de Participantes por Faixa</h3>
        <div class="chart-placeholder chart-donut-horizontal">
          <div class="chart-donut-canvas">
            <canvas id="donutFaixaCanvas"></canvas>
          </div>
          <div class="donut-highlights" *ngIf="donutFaixaLabels?.length">
            <div
              *ngFor="let faixa of donutFaixaLabels; let i = index"
              class="donut-highlight-card"
              [ngStyle]="{'border-left': '4px solid ' + donutFaixaColors[i], 'background': 'linear-gradient(87deg,'+ donutFaixaColors[i] +'21 60%, #f3f4f6)'}">
        <span class="label">
          <span class="icon-donut" [ngStyle]="{'color': donutFaixaColors[i]}">‚¨§</span>
          {{ faixa }}
        </span>
              <strong class="highlight-value">{{ donutFaixaData[i] }}</strong>
              <span class="subtitle">eventos</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Gr√°fico 5: Ocupa√ß√£o dos Eventos (Radar) -->
      <div class="chart-container">
        <h3>Gr√°fico 5: Radar de Ocupa√ß√£o de Eventos</h3>
      <div class="chart-placeholder chart-radar-horizontal">
        <div class="radar-top10-list">
          <table>
            <thead>
            <tr>
              <th style="width:32px">#</th>
              <th>Evento</th>
              <th style="width:70px">Ocupa√ß√£o</th>
            </tr>
            </thead>
            <tbody>
            <tr *ngFor="let ocup of radarTop10; let i = index">
              <td>{{ i+1 }}</td>
              <td>
            <span class="truncate-td" [title]="ocup.titulo">
              {{ ocup.titulo }}
            </span>
              </td>
              <td>
                <strong>{{ ocup.percentual }}%</strong>
              </td>
            </tr>
            </tbody>
          </table>
        </div>
        <div class="radar-graph">
          <canvas id="radarCanvas" width="720" height="720"></canvas>
        </div>
      </div>
  </div>

      <!-- Gr√°fico 6: Atividades por Tipo (Rosca) -->
      <div class="chart-container">
        <h3>Gr√°fico 6: Atividades por Tipo</h3>
        <div class="chart-placeholder">
          <p>üç© Gr√°fico de Rosca - Distribui√ß√£o de tipos de atividades</p>
          <div class="donut-chart">
            <div *ngFor="let ativ of dashboardData.atividadesPorTipo" class="donut-segment">
              <span class="donut-label">{{ ativ.tipo }}: {{ ativ.quantidade }}</span>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Eventos Mais Populares -->
    <section class="popular-events-section">
      <h2>Eventos Mais Populares</h2>
      <div class="events-list">
        <div *ngFor="let evento of dashboardData.eventosMaisPopulares" class="event-item">
          <h4>{{ evento.titulo }}</h4>
          <p>üë• {{ evento.participantes }} participantes</p>
        </div>
      </div>
    </section>
  </div>
</div>
