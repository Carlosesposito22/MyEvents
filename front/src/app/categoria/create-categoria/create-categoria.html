<div class="modal-overlay" (click)="!resultado && fechar.emit()">
  <div class="modal-content animate-scale" (click)="$event.stopPropagation()">

    <ng-container *ngIf="!resultado; else sucessoCriado">
      <button class="modal-close" (click)="fechar.emit()">‚úñ</button>
      <h2 class="titulo-pagina">üÜï Criar Categoria</h2>

      <form (ngSubmit)="criarCategoria()" #categoriaForm="ngForm" autocomplete="off">
        <div class="evento-form-row" style="flex-direction: column; gap: 16px;">

          <input type="text" [(ngModel)]="categoria.nome" name="nome" placeholder="Nome da Categoria" required class="evento-input"/>
          
          <div style="display: flex; gap: 10px;">
            <input type="number" [(ngModel)]="categoria.id_categoria_pai" name="id_categoria_pai" placeholder="ID da Categoria Pai (opcional)" class="evento-input"/>
          </div>

          <input type="text" [(ngModel)]="categoria.descricao" name="descricao" placeholder="Descri√ß√£o da Categoria" class="evento-input"/>
        </div>
        
        <div class="modal-footer">
          <button class="evento-btn" [disabled]="loading || categoriaForm.invalid" type="submit">
            {{ loading ? 'Criando...' : 'Criar Categoria' }}
          </button>
        </div>
      </form>

      <div *ngIf="loading" class="loading" style="justify-content:center;">
        <span class="spinner"></span> Criando categoria...
      </div>

      <div *ngIf="error && !loading" class="evento-erro">
        ‚ö†Ô∏è {{ error }}
      </div>
    </ng-container>

    <ng-template #sucessoCriado>
      <div class="evento-criado-final" style="display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:200px;">
        <div style="font-size:2.7rem; color:#16a34a; margin-bottom:10px; animation: popscale 0.18s;">
          üéâ
        </div>
        <div style="font-size:2rem;font-weight:800;color:#0084ff; margin-bottom:22px; text-align:center;">
          Categoria criada com sucesso!
        </div>
        <button class="evento-btn" style="margin-top:0;min-width:120px;" (click)="fechar.emit()">Fechar</button>
      </div>
    </ng-template>

  </div>
</div>

<style>
  @keyframes popscale {
    from { transform: scale(0.7); opacity:0.2;}
    to { transform: scale(1); opacity:1;}
  }
</style>